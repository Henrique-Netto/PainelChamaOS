CREATE TABLE clientes (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nome VARCHAR(255) NOT NULL,
    razao_social VARCHAR(255),
    cnpj VARCHAR(20),

    subdominio VARCHAR(100) NOT NULL UNIQUE,
    email VARCHAR(255),
    contato VARCHAR(100),

    status ENUM('ativo', 'suspenso', 'cancelado') DEFAULT 'ativo',

    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);


CREATE TABLE licencas (
    id INT AUTO_INCREMENT PRIMARY KEY,
    cliente_id INT NOT NULL,

    plano VARCHAR(50) DEFAULT 'basico',
    data_inicio DATE NOT NULL,
    data_fim DATE NOT NULL,

    status ENUM('ativa', 'vencida', 'suspensa') DEFAULT 'ativa',

    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

    CONSTRAINT fk_licenca_cliente 
        FOREIGN KEY (cliente_id) REFERENCES clientes(id)
        ON DELETE CASCADE
);


CREATE TABLE usuarios (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nome VARCHAR(100) NOT NULL,
    usuario VARCHAR(50) NOT NULL UNIQUE,
    senha VARCHAR(255) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;


usuario master com senha 123

INSERT INTO usuarios (nome, usuario, senha)
VALUES (
    'Administrador',
    'master',
    '$2y$10$g7W7QEa5tkLAo3Ds16nSlu8Vp2YEqH8SUHxedZ.5jyCc1DYefqBua'
);



CREATE TABLE logs_validacao (
    id INT AUTO_INCREMENT PRIMARY KEY,
    cliente_id INT,

    subdominio VARCHAR(100),
    ip VARCHAR(45),
    resultado ENUM('ok', 'vencida', 'suspensa', 'inexistente'),
    data_validacao DATETIME DEFAULT CURRENT_TIMESTAMP,

    INDEX (cliente_id),
    INDEX (subdominio)
);
